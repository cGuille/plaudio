#!/usr/bin/env bash

set -eu

SOURCES=(
    src/functions.js
    src/widgets/base.js
    src/widgets/click.js
    src/widgets/nowplaying.js
    src/widgets/timer.js
    src/widgets/duration.js
    src/widgets/playpause.js
    src/widgets/prev.js
    src/widgets/next.js
    src/widgets/deltaseeker.js
    src/widgets/seeker.js
    src/widgets/keybinds.js
    src/track.js
    src/plaudio.js
    src/exports.js
)

DEST=dist/plaudio.js

echo -n > "$DEST"

cat >> "$DEST" <<JS
(function () {
    'use strict';

JS

for source_file in "${SOURCES[@]}"
do
    echo "< $source_file"

    echo >> "$DEST"
    cat "$source_file" >> "$DEST"
    echo >> "$DEST"
done

cat >> "$DEST" <<JS

}());
JS

echo
echo "> $DEST"
